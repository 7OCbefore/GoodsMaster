import{i as Z,r as P,g as z,o as l,a as r,b as t,t as o,d as f,p as Y,w as H,u as n,F as L,k as M,f as R,m as I,T as W,s as gt}from"./vue-vendor-1f2ac135.js";import{u as ht}from"./inbox-view-72564b2b.js";import{u as C,w as ft}from"./xlsx-f5126985.js";import"./supabase-vendor-75f53c49.js";function yt(){const T=({salesHistory:d,inventoryList:c,selectedDate:m})=>{try{const i=C.book_new(),E=q(d),j=C.json_to_sheet(E);j["!cols"]=[{wch:15},{wch:12},{wch:8},{wch:10},{wch:20},{wch:10},{wch:10},{wch:8},{wch:12},{wch:12},{wch:10}],C.book_append_sheet(i,j,"销售流水明细");const b=u(d),F=C.json_to_sheet(b);F["!cols"]=[{wch:15},{wch:18},{wch:10},{wch:12},{wch:12},{wch:10},{wch:30},{wch:10}],C.book_append_sheet(i,F,"订单总表");const O=g(c),G=C.json_to_sheet(O);G["!cols"]=[{wch:20},{wch:12},{wch:12},{wch:15}],C.book_append_sheet(i,G,"当前库存快照");const $=`GoodsMaster数据导出_${m?new Date(m).toLocaleDateString("zh-CN").replace(/\//g,"-"):new Date().toLocaleDateString("zh-CN").replace(/\//g,"-")}.xlsx`;return ft(i,$),{success:!0,fileName:$}}catch(i){return console.error("导出失败:",i),{success:!1,error:i.message}}},q=d=>{const c=[];return d.forEach(m=>{const i=new Date(m.timestamp),E=i.toLocaleDateString("zh-CN"),j=i.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"});m.items.forEach(b=>{const F=b.sellPrice*b.quantity,O=(b.sellPrice-b.costSnapshot)*b.quantity;c.push({订单号:m.id,日期:E,时间:j,客户:m.customer||"散客",商品名称:b.name,销售单价:Number(b.sellPrice).toFixed(2),成本单价:Number(b.costSnapshot).toFixed(2),数量:b.quantity,小计金额:Number(F).toFixed(2),小计毛利:Number(O).toFixed(2),订单状态:m.status==="refunded"?"已退款":"已完成"})})}),c},u=d=>d.map(c=>({订单号:c.id,时间:new Date(c.timestamp).toLocaleString("zh-CN"),客户:c.customer||"散客",总金额:Number(c.totalAmount).toFixed(2),总毛利:Number(c.totalProfit).toFixed(2),商品种类数:c.items.length,备注:c.note||"",状态:c.status==="refunded"?"已退款":"已完成"})),g=d=>d.map(c=>({商品名称:c.name,当前库存:c.quantity,平均成本:Number(c.averageCost).toFixed(2),库存资产值:Number(c.quantity*c.averageCost).toFixed(2)}));return{exportToExcel:T}}const mt=(T,q)=>{const u=T.__vccOpts||T;for(const[g,d]of q)u[g]=d;return u},wt={class:"flex flex-col h-full bg-[#F5F5F7]"},_t={class:"px-5 pt-safe bg-surface sticky top-0 z-30 shadow-sm border-b border-gray-100"},Dt={class:"py-4 flex items-center justify-between w-full"},kt={class:"flex items-center gap-2 relative"},St=["disabled"],Ct={key:0,class:"ph-bold ph-microsoft-excel-logo text-green-600 text-lg"},jt={key:1,class:"ph-bold ph-spinner text-green-600 text-lg animate-spin"},Ft={class:"text-sm font-bold text-primary whitespace-nowrap select-none"},Nt={key:0,class:"absolute top-12 right-0 z-50"},Pt={class:"bg-white rounded-2xl shadow-2xl border border-gray-100 p-4 w-80 animate-pop"},zt={class:"bg-gradient-to-r from-primary to-accent text-white rounded-xl p-3 mb-3"},Lt={class:"flex items-baseline gap-2"},Mt={class:"text-2xl font-bold"},Tt={class:"text-sm"},qt={class:"text-xs mt-1 opacity-90"},Et={class:"flex items-center justify-between mb-3"},$t={class:"text-sm font-bold text-primary"},At={class:"grid grid-cols-7 gap-1 mb-2"},It={class:"grid grid-cols-7 gap-1"},Ot=["onClick"],Vt={key:0,class:"absolute -top-0.5 -right-0.5 w-1.5 h-1.5 bg-accent rounded-full"},Bt={class:"mt-3 pt-3 border-t border-gray-100 flex gap-2"},Yt={class:"flex-1 overflow-y-auto p-5 pb-32 space-y-5 hide-scrollbar"},Ht={class:"bg-gradient-to-r from-primary to-accent rounded-[28px] p-6 text-white shadow-xl shadow-primary/20 relative overflow-hidden group"},Rt={class:"relative z-10"},Wt={class:"text-[46px] font-bold tracking-tight mb-6 leading-none font-mono"},Gt={class:"grid grid-cols-3 gap-2 border-t border-white/10 pt-4"},Jt={class:"text-base font-bold"},Kt={class:"border-l border-white/10 pl-3"},Qt={class:"text-base font-bold"},Ut={class:"border-l border-white/10 pl-3"},Xt={class:"text-base font-bold text-white"},Zt={class:"bg-white rounded-[24px] p-5 shadow-sm border border-gray-100"},te={class:"flex justify-between items-start mb-4"},ee={class:"flex items-baseline gap-2"},se={class:"text-2xl font-bold text-primary"},oe={key:0,class:"ph-bold ph-trend-up text-lg"},ae={key:1,class:"ph-bold ph-trend-down text-lg"},ne={key:2,class:"ph-bold ph-minus text-lg"},le={class:"text-xs font-bold"},re={class:"text-right"},ie={class:"text-xs text-gray-500"},de={key:0,class:"mb-4 bg-gradient-to-r from-primary/5 to-accent/5 rounded-xl p-3 border border-primary/10"},ce={class:"flex items-center justify-between"},ue={class:"flex items-center gap-2"},xe={class:"text-xs font-bold text-primary"},ve={class:"text-right"},pe={class:"text-lg font-bold text-primary"},be={key:1,class:"mb-4 text-center text-xs text-gray-400 py-2"},ge={class:"h-60 flex items-end gap-1.5 relative overflow-x-auto hide-scrollbar px-2 -mx-2"},he=["onClick"],fe={class:"w-full bg-gray-50 rounded-t-xl relative overflow-hidden h-40 flex items-end"},ye={key:0,class:"absolute -top-9 left-1/2 -translate-x-1/2 bg-[#0A84FF] text-white px-2.5 py-1 rounded-lg text-xs font-bold whitespace-nowrap shadow-lg"},me={class:"flex flex-col items-center gap-0.5"},we={key:0,class:"w-1 h-1 rounded-full bg-[#0A84FF]"},_e={class:"mt-4 pt-4 border-t border-gray-100 grid grid-cols-3 gap-3"},De={class:"text-center"},ke={class:"text-sm font-bold text-success"},Se={class:"text-center border-l border-r border-gray-100"},Ce={class:"text-sm font-bold text-primary"},je={class:"text-center"},Fe={class:"text-sm font-bold text-gray-400"},Ne={class:"grid grid-cols-2 gap-4"},Pe={class:"bg-white rounded-[24px] p-4 shadow-sm border border-gray-100"},ze={class:"text-2xl font-bold text-primary"},Le={class:"bg-white rounded-[24px] p-4 shadow-sm border border-gray-100 relative overflow-hidden"},Me={class:"text-[10px] text-gray-400 font-bold uppercase mb-2 flex justify-between"},Te={class:"text-danger font-bold"},qe={class:"space-y-2"},Ee={key:0,class:"text-xs text-gray-300 py-1"},$e={class:"font-bold text-primary truncate max-w-[60%]"},Ae={class:"bg-danger/10 text-danger px-1.5 py-0.5 rounded font-bold"},Ie={class:"font-bold text-primary text-sm mb-3 px-1 flex items-center justify-between"},Oe={class:"bg-gray-200 text-gray-600 px-2 py-0.5 rounded text-[10px]"},Ve={class:"space-y-3"},Be={key:0,class:"text-center py-10 text-gray-400 text-xs"},Ye=["onClick"],He={class:"flex items-center gap-3"},Re={class:"font-bold text-sm text-primary"},We={class:"text-[10px] text-gray-400 font-medium"},Ge={class:"text-right"},Je={class:"text-xs font-bold text-success"},Ke={class:"text-[10px] text-gray-300"},Qe={key:0,class:"fixed inset-0 z-[100] flex flex-col justify-end"},Ue={class:"bg-surface w-full h-[85vh] rounded-t-[32px] relative z-10 flex flex-col shadow-2xl animate-fade-in overflow-hidden"},Xe={class:"bg-white px-6 py-4 border-b border-gray-100 flex justify-between items-center shrink-0"},Ze={key:0,class:"flex-1 overflow-y-auto p-5 bg-gray-50"},ts={class:"bg-white p-5 rounded-2xl shadow-sm border border-gray-100 relative overflow-hidden receipt-pattern"},es={key:0,class:"absolute right-4 top-4 border-2 border-gray-300 text-gray-300 font-bold px-2 py-1 rounded rotate-12 text-sm"},ss={class:"flex justify-between items-start mb-6"},os={class:"font-bold text-primary text-lg"},as={class:"text-right"},ns={class:"text-sm font-bold text-gray-600"},ls={class:"space-y-3 mb-6 border-t border-dashed border-gray-200 pt-4"},rs={class:"font-bold text-primary"},is={class:"text-[10px] text-gray-400 mt-0.5"},ds={class:"text-right"},cs={class:"font-bold"},us={class:"text-[10px] text-success font-medium"},xs={class:"border-t border-gray-100 pt-4 space-y-2"},vs={class:"flex justify-between text-sm"},ps={class:"font-bold text-primary"},bs={class:"flex justify-between text-sm"},gs={class:"font-bold text-success"},hs={key:1,class:"mt-4 bg-yellow-50 p-3 rounded-xl border border-yellow-100 text-xs text-yellow-700"},fs={key:1,class:"bg-white p-4 border-t border-gray-100 pb-safe grid grid-cols-2 gap-3 shrink-0"},ys={__name:"DashboardView",setup(T){const q=ht(),{selectedDate:u,dailyStats:g,chartData:d,lowStockItems:c,topSelling:m,formatCurrency:i,refundOrder:E,updateOrderNote:j,salesHistory:b,inventoryList:F,user:O,loadData:G}=q,N=Z("showToast"),$=Z("showDialog"),{exportToExcel:tt}=yt(),w=P(!1),h=P(new Date),_=P(null),et=z(()=>{const a=new Date,e=new Date(u.value);return a.toDateString()===e.toDateString()}),U=()=>{u.value=new Date,u.value.setHours(0,0,0,0),h.value=new Date,w.value=!1},st=z(()=>new Date(u.value).toLocaleDateString("zh-CN",{month:"short",day:"numeric",weekday:"short"})),ot=z(()=>new Date(u.value).toLocaleDateString("zh-CN",{weekday:"long"})),y=z(()=>{const a=d.value.values.reduce((S,Q)=>S+Q,0),e=a/d.value.values.length,s=Math.max(...d.value.values),v=Math.min(...d.value.values),D=d.value.values[d.value.values.length-1],k=d.value.values[d.value.values.length-2],K=D>k?"up":D<k?"down":"stable",B=k>0?((D-k)/k*100).toFixed(1):0;return{total:a,avg:e,max:s,min:v,trend:K,trendPercent:B}}),at=a=>{if(a==null)return"";const e=new Date(u.value),s=new Date(e);return s.setDate(s.getDate()-(6-a)),s.toLocaleDateString("zh-CN",{month:"short",day:"numeric",weekday:"short"})},nt=a=>{_.value=_.value===a?null:a},lt=()=>{w.value=!w.value,w.value&&(h.value=new Date(u.value))},rt=z(()=>{const a=h.value.getFullYear(),e=h.value.getMonth(),s=new Date(a,e,1),v=new Date(a,e+1,0),D=new Date(a,e,0),k=s.getDay(),K=v.getDate(),B=D.getDate(),S=[];for(let p=k-1;p>=0;p--)S.push({date:B-p,isCurrentMonth:!1,fullDate:new Date(a,e-1,B-p)});for(let p=1;p<=K;p++)S.push({date:p,isCurrentMonth:!0,fullDate:new Date(a,e,p)});const Q=42-S.length;for(let p=1;p<=Q;p++)S.push({date:p,isCurrentMonth:!1,fullDate:new Date(a,e+1,p)});return S}),it=z(()=>h.value.toLocaleDateString("zh-CN",{year:"numeric",month:"long"})),dt=()=>{h.value=new Date(h.value.getFullYear(),h.value.getMonth()-1)},ct=()=>{h.value=new Date(h.value.getFullYear(),h.value.getMonth()+1)},ut=a=>{a.isCurrentMonth||(h.value=new Date(a.fullDate)),u.value=new Date(a.fullDate),u.value.setHours(0,0,0,0),w.value=!1},J=a=>{const e=new Date(u.value);return a.fullDate.toDateString()===e.toDateString()},X=a=>{const e=new Date;return a.fullDate.toDateString()===e.toDateString()},A=P(!1),x=P(null),xt=a=>{x.value=a,A.value=!0},vt=()=>{x.value&&$({title:"确认退单",content:"退单后库存将自动恢复，且该笔金额从统计中扣除。",isDanger:!0,confirmText:"确认退款",action:async()=>{const a=await E(x.value.id);a.error?N("退单失败: "+a.error.message,"error"):(N("已退单"),A.value=!1)}})},pt=()=>{x.value&&$({title:"修改备注",isInput:!0,inputValue:x.value.note||"",confirmText:"保存",action:a=>{j(x.value.id,a),N("备注已更新")}})},V=P(!1),bt=async()=>{V.value=!0,await new Promise(e=>setTimeout(e,300));const a=tt({salesHistory:b.value,inventoryList:F.value,selectedDate:u.value});V.value=!1,a.success?N(`✅ 导出成功：${a.fileName}`):N(`❌ 导出失败：${a.error}`)};return(a,e)=>(l(),r("div",wt,[t("header",_t,[t("div",Dt,[e[9]||(e[9]=t("h1",{class:"text-2xl font-extrabold text-primary tracking-tight leading-none"},"经营总览",-1)),t("div",kt,[t("button",{onClick:bt,disabled:V.value,class:"bg-white p-2 rounded-full border border-gray-200 shadow-sm flex items-center justify-center cursor-pointer active:bg-gray-50 transition-all hover:border-green-500 hover:bg-green-50 min-h-[36px] min-w-[36px] disabled:opacity-50 disabled:cursor-not-allowed",title:"导出数据到Excel"},[V.value?(l(),r("i",jt)):(l(),r("i",Ct))],8,St),t("button",{onClick:lt,class:"bg-white px-3 py-2 rounded-full border border-gray-200 shadow-sm flex items-center gap-2 cursor-pointer active:bg-gray-50 transition-colors hover:border-primary min-h-[36px]"},[e[4]||(e[4]=t("i",{class:"ph-bold ph-calendar-blank text-accent"},null,-1)),t("span",Ft,o(st.value),1)]),et.value?f("",!0):(l(),r("button",{key:0,onClick:U,class:"w-8 h-8 rounded-full bg-[#0A84FF] text-white flex items-center justify-center shadow-lg active:scale-90 transition-transform flex-shrink-0",title:"回到今天"},[...e[5]||(e[5]=[t("span",{class:"text-sm font-bold"},"今",-1)])])),Y(W,{name:"fade"},{default:H(()=>[w.value?(l(),r("div",Nt,[t("div",{onClick:e[0]||(e[0]=s=>w.value=!1),class:"fixed inset-0 -z-10"}),t("div",Pt,[t("div",zt,[e[6]||(e[6]=t("div",{class:"text-xs opacity-80 mb-1"},"已选日期",-1)),t("div",Lt,[t("span",Mt,o(new Date(n(u)).getDate()),1),t("span",Tt,o(new Date(n(u)).toLocaleDateString("zh-CN",{year:"numeric",month:"long"})),1)]),t("div",qt,o(ot.value),1)]),t("div",Et,[t("button",{onClick:dt,class:"w-8 h-8 rounded-full hover:bg-gray-100 flex items-center justify-center transition-colors"},[...e[7]||(e[7]=[t("i",{class:"ph-bold ph-caret-left text-primary"},null,-1)])]),t("span",$t,o(it.value),1),t("button",{onClick:ct,class:"w-8 h-8 rounded-full hover:bg-gray-100 flex items-center justify-center transition-colors"},[...e[8]||(e[8]=[t("i",{class:"ph-bold ph-caret-right text-primary"},null,-1)])])]),t("div",At,[(l(),r(L,null,M(["日","一","二","三","四","五","六"],s=>t("div",{key:s,class:"text-center text-xs font-bold text-gray-400 py-1"},o(s),1)),64))]),t("div",It,[(l(!0),r(L,null,M(rt.value,(s,v)=>(l(),r("button",{key:v,onClick:D=>ut(s),class:R(["aspect-square rounded-lg text-sm flex items-center justify-center transition-all relative",[s.isCurrentMonth?"text-primary hover:bg-gray-50":"text-gray-300",J(s)?"bg-primary text-white hover:bg-primary font-bold shadow-md scale-105":"",X(s)&&!J(s)?"border-2 border-accent font-bold":""]])},[I(o(s.date)+" ",1),X(s)&&!J(s)?(l(),r("span",Vt)):f("",!0)],10,Ot))),128))]),t("div",Bt,[t("button",{onClick:U,class:"flex-1 py-2 rounded-lg bg-gray-50 hover:bg-gray-100 text-xs font-bold text-primary transition-colors"}," 回到今天 "),t("button",{onClick:e[1]||(e[1]=s=>w.value=!1),class:"flex-1 py-2 rounded-lg bg-[#0A84FF] text-white text-xs font-bold hover:bg-opacity-90 transition-colors"}," 确定 ")])])])):f("",!0)]),_:1})])])]),t("div",Yt,[t("div",Ht,[e[15]||(e[15]=t("div",{class:"absolute right-0 top-0 w-48 h-48 bg-white/10 rounded-full blur-[60px] group-hover:bg-white/20 transition-all duration-700"},null,-1)),t("div",Rt,[e[14]||(e[14]=t("div",{class:"flex justify-between items-start mb-2"},[t("span",{class:"text-xs font-bold text-white/60 uppercase tracking-widest"},"净利润 (Profit)")],-1)),t("div",Wt,[e[10]||(e[10]=t("span",{class:"text-2xl text-white/70 font-sans mr-1"},"¥",-1)),I(o(n(i)(n(g).profit)),1)]),t("div",Gt,[t("div",null,[e[11]||(e[11]=t("div",{class:"text-[10px] text-white/60 mb-0.5"},"营收",-1)),t("div",Jt,"¥"+o(n(i)(n(g).revenue)),1)]),t("div",Kt,[e[12]||(e[12]=t("div",{class:"text-[10px] text-white/60 mb-0.5"},"订单",-1)),t("div",Qt,o(n(g).count),1)]),t("div",Ut,[e[13]||(e[13]=t("div",{class:"text-[10px] text-white/60 mb-0.5"},"利润率",-1)),t("div",Xt,o(n(g).marginRate)+"%",1)])])])]),t("div",Zt,[t("div",te,[t("div",null,[e[16]||(e[16]=t("h3",{class:"font-bold text-primary text-sm flex items-center gap-1 mb-2"},[t("i",{class:"ph-bold ph-chart-line text-accent"}),I(" 利润趋势 ")],-1)),t("div",ee,[t("span",se,"￥"+o(n(i)(y.value.total)),1),t("div",{class:R(["flex items-center gap-1",{"text-success":y.value.trend==="up","text-danger":y.value.trend==="down","text-gray-400":y.value.trend==="stable"}])},[y.value.trend==="up"?(l(),r("i",oe)):y.value.trend==="down"?(l(),r("i",ae)):(l(),r("i",ne)),t("span",le,o(Math.abs(y.value.trendPercent))+"%",1)],2)])]),t("div",re,[e[17]||(e[17]=t("div",{class:"text-[10px] text-gray-400 mb-1"},"近7天总计",-1)),t("div",ie,"均值 ￥"+o(n(i)(y.value.avg)),1)])]),Y(W,{name:"fade",mode:"out-in"},{default:H(()=>[_.value!==null?(l(),r("div",de,[t("div",ce,[t("div",ue,[e[19]||(e[19]=t("div",{class:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center"},[t("i",{class:"ph-bold ph-calendar text-primary text-sm"})],-1)),t("div",null,[e[18]||(e[18]=t("div",{class:"text-[10px] text-gray-500"},"日期",-1)),t("div",xe,o(at(_.value)),1)])]),t("div",ve,[e[20]||(e[20]=t("div",{class:"text-[10px] text-gray-500 mb-0.5"},"当日利润",-1)),t("div",pe,"¥"+o(n(i)(n(d).values[_.value])),1)])])])):(l(),r("div",be,[...e[21]||(e[21]=[t("i",{class:"ph-duotone ph-hand-tap text-lg opacity-50"},null,-1),t("p",null,"点击柱子查看详情",-1)])]))]),_:1}),t("div",ge,[e[25]||(e[25]=t("div",{class:"absolute inset-0 flex flex-col justify-between pointer-events-none"},[t("div",{class:"border-t border-dashed border-gray-200"}),t("div",{class:"border-t border-dashed border-gray-200"}),t("div",{class:"border-t border-dashed border-gray-200"})],-1)),(l(!0),r(L,null,M(n(d).labels,(s,v)=>(l(),r("div",{key:v,onClick:D=>nt(v),class:"flex-1 flex flex-col items-center gap-2 group cursor-pointer relative z-10 min-w-[40px] active:opacity-70 transition-opacity"},[t("div",fe,[e[24]||(e[24]=t("div",{class:"absolute inset-0 bg-gradient-to-t from-primary/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"},null,-1)),t("div",{class:R(["w-full rounded-t-xl transition-all duration-500 min-h-[0px] relative overflow-hidden",[s.active?"bg-gradient-to-t from-primary to-accent shadow-lg":"bg-gradient-to-t from-primary/60 to-accent/60",_.value===v?"shadow-xl ring-2 ring-primary/30":""]]),style:gt({height:n(d).values[v]===0?"0%":Math.max(30,n(d).values[v]/n(d).max*70+30)+"%"})},[e[23]||(e[23]=t("div",{class:"absolute top-0 inset-x-0 h-1 bg-white/30"},null,-1)),Y(W,{name:"fade"},{default:H(()=>[_.value===v?(l(),r("div",ye,[I(" ￥"+o(n(i)(n(d).values[v]))+" ",1),e[22]||(e[22]=t("div",{class:"absolute bottom-0 left-1/2 -translate-x-1/2 translate-y-full w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-[#0A84FF]"},null,-1))])):f("",!0)]),_:2},1024)],6)]),t("div",me,[t("span",{class:R(["text-[10px] font-bold transition-all duration-300",[s.active?"text-primary scale-110":"text-gray-400",_.value===v?"text-accent scale-105":""]])},o(s.label),3),s.active?(l(),r("div",we)):f("",!0)])],8,he))),128))]),t("div",_e,[t("div",De,[e[26]||(e[26]=t("div",{class:"text-[10px] text-gray-400 mb-1"},"最高",-1)),t("div",ke,"￥"+o(n(i)(y.value.max)),1)]),t("div",Se,[e[27]||(e[27]=t("div",{class:"text-[10px] text-gray-400 mb-1"},"平均",-1)),t("div",Ce,"￥"+o(n(i)(y.value.avg)),1)]),t("div",je,[e[28]||(e[28]=t("div",{class:"text-[10px] text-gray-400 mb-1"},"最低",-1)),t("div",Fe,"￥"+o(n(i)(y.value.min)),1)])])]),t("div",Ne,[t("div",Pe,[e[29]||(e[29]=t("div",{class:"text-[10px] text-gray-400 font-bold uppercase mb-1"},"日均销售额",-1)),t("div",ze,"¥"+o(n(i)(n(g).revenue)),1)]),t("div",Le,[t("div",Me,[e[30]||(e[30]=t("span",null,"库存预警",-1)),t("span",Te,o(n(c).length),1)]),t("div",qe,[n(c).length?f("",!0):(l(),r("div",Ee,"库存健康")),(l(!0),r(L,null,M(n(c),s=>(l(),r("div",{key:s.name,class:"flex justify-between items-center text-xs"},[t("span",$e,o(s.name),1),t("span",Ae,"剩"+o(s.quantity),1)]))),128))])])]),t("div",null,[t("h3",Ie,[e[31]||(e[31]=t("span",null,"当日订单",-1)),t("span",Oe,o(n(g).count),1)]),t("div",Ve,[n(g).orders.length===0?(l(),r("div",Be,[...e[32]||(e[32]=[t("i",{class:"ph-duotone ph-receipt text-3xl mb-2 opacity-50"},null,-1),t("p",null,"该日期暂无销售记录",-1)])])):f("",!0),(l(!0),r(L,null,M(n(g).orders,s=>(l(),r("div",{key:s.id,onClick:v=>xt(s),class:"bg-white p-4 rounded-2xl shadow-sm border border-gray-50 flex justify-between items-center active:scale-[0.98] transition-transform"},[t("div",He,[e[33]||(e[33]=t("div",{class:"w-10 h-10 rounded-full bg-gray-50 flex items-center justify-center text-primary font-bold shadow-inner"},[t("i",{class:"ph-bold ph-bag"})],-1)),t("div",null,[t("div",Re,"¥"+o(n(i)(s.totalAmount)),1),t("div",We,o(new Date(s.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))+" · "+o(s.customer||"散客"),1)])]),t("div",Ge,[t("div",Je,"+¥"+o(n(i)(s.totalProfit)),1),t("div",Ke,o(s.items.length)+" 种商品",1)])],8,Ye))),128))])])]),Y(W,{name:"fade"},{default:H(()=>[A.value?(l(),r("div",Qe,[t("div",{class:"absolute inset-0 bg-black/40 backdrop-blur-sm transition-opacity",onClick:e[2]||(e[2]=s=>A.value=!1)}),t("div",Ue,[t("div",Xe,[e[35]||(e[35]=t("h2",{class:"text-lg font-bold text-primary"},"订单详情",-1)),t("button",{onClick:e[3]||(e[3]=s=>A.value=!1),class:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center active:bg-gray-200"},[...e[34]||(e[34]=[t("i",{class:"ph-bold ph-x text-lg"},null,-1)])])]),x.value?(l(),r("div",Ze,[t("div",ts,[x.value.status==="refunded"?(l(),r("div",es,"已退款")):f("",!0),t("div",ss,[t("div",null,[e[36]||(e[36]=t("div",{class:"text-xs text-gray-400 mb-1"},"客户信息",-1)),t("div",os,o(x.value.customer||"散客"),1)]),t("div",as,[e[37]||(e[37]=t("div",{class:"text-xs text-gray-400 mb-1"},"时间",-1)),t("div",ns,o(new Date(x.value.timestamp).toLocaleString()),1)])]),t("div",ls,[(l(!0),r(L,null,M(x.value.items,s=>(l(),r("div",{key:s.name,class:"flex justify-between items-center text-sm"},[t("div",null,[t("div",rs,o(s.name),1),t("div",is," 成本 ¥"+o(n(i)(s.costSnapshot))+" × "+o(s.quantity),1)]),t("div",ds,[t("div",cs,"¥"+o(n(i)(s.sellPrice*s.quantity)),1),t("div",us,"赚 ¥"+o(n(i)((s.sellPrice-s.costSnapshot)*s.quantity)),1)])]))),128))]),t("div",xs,[t("div",vs,[e[38]||(e[38]=t("span",{class:"text-gray-500"},"总计金额",-1)),t("span",ps,"¥"+o(n(i)(x.value.totalAmount)),1)]),t("div",bs,[e[39]||(e[39]=t("span",{class:"text-gray-500"},"总毛利",-1)),t("span",gs,"+¥"+o(n(i)(x.value.totalProfit)),1)])]),x.value.note?(l(),r("div",hs,[e[40]||(e[40]=t("span",{class:"font-bold"},"备注：",-1)),I(" "+o(x.value.note),1)])):f("",!0)])])):f("",!0),x.value&&x.value.status!=="refunded"?(l(),r("div",fs,[t("button",{onClick:pt,class:"py-3.5 rounded-xl font-bold text-primary bg-gray-100 active:bg-gray-200 transition-colors"},o(x.value.note?"修改备注":"添加备注"),1),t("button",{onClick:vt,class:"py-3.5 rounded-xl font-bold text-danger bg-danger/10 active:bg-danger/20 transition-colors"}," 退单 ")])):f("",!0)])])):f("",!0)]),_:1})]))}},ks=mt(ys,[["__scopeId","data-v-7e20fe99"]]);export{ks as default};
