import{u as b}from"./inbox-view-72564b2b.js";import{i as u,o as h,a as y,b as s,x as n}from"./vue-vendor-1f2ac135.js";import"./supabase-vendor-75f53c49.js";const w={class:"p-5 pt-safe space-y-8 bg-surface h-full"},k={class:"bg-white rounded-[24px] shadow-sm border border-gray-100 overflow-hidden"},j={class:"p-5 flex items-center justify-between active:bg-gray-50 transition-colors cursor-pointer"},O={__name:"SettingsView",setup(S){const g=b(),{packages:c,goodsList:d,salesHistory:p,sellPrice:x,user:_,loadData:B}=g,l=u("showToast"),v=u("showDialog"),f=()=>{const a=JSON.stringify({packages:c.value,goodsList:d.value,salesHistory:p.value,sellPrice:x.value,version:"2.0"}),e=new Blob([a],{type:"application/json"}),i=URL.createObjectURL(e),o=document.createElement("a");o.href=i,o.download=`GoodsMaster_Backup_${new Date().toISOString().slice(0,10)}.json`,o.click(),l("备份已下载")},m=a=>{const e=a.target.files[0];if(!e)return;const i=new FileReader;i.onload=o=>{try{const t=JSON.parse(o.target.result);v({title:"恢复数据",content:"此操作将覆盖当前所有数据，且不可撤销。确定继续吗？",isDanger:!0,action:()=>{t.packages&&(t.packages.forEach(r=>{r.batchId||(r.batchId=`FIX_${r.timestamp}_${r.content}`)}),c.value=t.packages),t.goodsList&&(d.value=t.goodsList),t.salesHistory&&(p.value=t.salesHistory),t.sellPrice&&(x.value=t.sellPrice),l("数据已恢复")}})}catch{l("文件格式错误","error")}},i.readAsText(e),a.target.value=""};return(a,e)=>(h(),y("div",w,[e[3]||(e[3]=s("header",{class:"py-2"},[s("h1",{class:"text-[32px] font-bold text-primary tracking-tight"},"设置")],-1)),s("div",k,[s("div",{onClick:f,class:"p-5 border-b border-gray-50 flex items-center justify-between active:bg-gray-50 transition-colors cursor-pointer"},[...e[0]||(e[0]=[n('<div class="flex items-center gap-4"><div class="w-10 h-10 rounded-full bg-blue-50 text-blue-600 flex items-center justify-center"><i class="ph-bold ph-download-simple text-xl"></i></div><div><div class="font-bold text-primary text-sm">备份数据</div><div class="text-[10px] text-gray-400">导出 JSON 文件</div></div></div><i class="ph-bold ph-caret-right text-gray-300"></i>',2)])]),s("label",j,[e[1]||(e[1]=n('<div class="flex items-center gap-4"><div class="w-10 h-10 rounded-full bg-orange-50 text-orange-600 flex items-center justify-center"><i class="ph-bold ph-upload-simple text-xl"></i></div><div><div class="font-bold text-primary text-sm">恢复数据</div><div class="text-[10px] text-gray-400">导入 JSON 文件</div></div></div>',1)),s("input",{type:"file",accept:".json",class:"hidden",onChange:m},null,32),e[2]||(e[2]=s("i",{class:"ph-bold ph-caret-right text-gray-300"},null,-1))])]),e[4]||(e[4]=n('<div class="text-center space-y-1"><div class="w-12 h-12 bg-[#0A84FF] rounded-2xl mx-auto mb-3 shadow-xl flex items-center justify-center text-white"><i class="ph-fill ph-package text-2xl"></i></div><p class="text-xs font-bold text-primary">GoodsMaster Pro</p><p class="text-[10px] text-gray-400 font-mono">v2.0.0 (Premium Dark)</p></div>',1))]))}};export{O as default};
