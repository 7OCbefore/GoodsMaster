# **Chat Summary: GoodsMaster Pro (烟草管家 Pro) 项目总结**

## **1\. 项目概况**

* **项目名称**: GoodsMaster Pro (烟草管家 Pro)  
* **应用类型**: 移动端 Web App (SPA)  
* **核心业务**: 烟草/高端零售行业的“进销存”管理。  
* **用户画像**: 个体户老板，需要极速录入、扫码核验、精确计算利润。  
* **技术栈**: Vue 3 (Composition API), Vite, Tailwind CSS, LocalStorage (纯本地存储，无后端)。

## **2\. 核心业务流程 (Business Logic)**

### **A. 进货 (Inbox)**

* **场景**: 微信接收上家图片 \-\> 预录入 \-\> 快递到货扫码核验 \-\> 入库。  
* **直入模式 (Direct Entry)**: 针对非快递渠道，提供“直入模式”，跳过扫码步骤，自动生成 DIRECT\_ 开头的单号并直接入库。  
* **数据流**: 包裹从 verified: false (待收) 变为 verified: true (已入库)。

### **B. 库存 (Inventory)**

* **核心算法**: **移动加权平均法 (WAC)**。  
  * 库存并非独立数据表，而是通过计算属性 (computed) 实时聚合“已入库进货”减去“已销售出库”得出。  
  * **成本计算**: (历史总成本 \+ 新进货成本) / (历史总数量 \+ 新进货数量)。  
* **特性**: 零数据库设计，数据强一致性。

### **C. 销售 (Sales)**

* **模式**: POS 收银台模式。左侧分类侧边栏 \+ 右侧商品网格 \+ 底部悬浮购物车。  
* **成本快照 (Snapshot Strategy)**: **(关键逻辑)** 在结账瞬间，系统读取当前的库存均价并写入销售记录的 costSnapshot 字段。即使未来进价波动，历史订单的利润永远固定。  
* **功能**: 改价（支持单次改价和全局默认售价修改）、直接输入数量、历史订单管理（退单、备注）。

### **D. 总览 (Dashboard)**

* **设计**: "Modern Retail Analytics" 风格，Bento Grid 布局。  
* **时间旅行**: 顶部含日期选择器，可查看任意日期的经营数据。  
* **电子小票**: 点击每日订单流，弹出拟物化小票详情页。  
* **指标**: 净利润 (核心)、营收、毛利率、客单价 (AOV)、近7天真实趋势图。

## **3\. UI/UX 设计规范**

* **主题**: **Premium Dark (黑金/深蓝)**。  
  * Primary: \#1C1C1E (深黑)  
  * Surface: \#F2F2F7 (iOS 灰)  
  * Accent: \#0A84FF (蓝) 或 \#F59E0B (金)  
* **交互细节**:  
  * **Safe Area**: 严格适配 iOS 底部横条 (pb-safe) 和刘海屏 (pt-safe)。  
  * **Z-Index**: 购物车抽屉和弹窗必须为 z-\[100\] 以覆盖底部导航栏。  
  * **触感**: 关键操作支持 navigator.vibrate。

## **4\. 当前开发进度**

* **状态**: 核心功能 (Step 1-4) 已完成，处于 UI 细节打磨和体验优化阶段。  
* **最新版本**: v2.0 (重构了 Sales 和 Dashboard，增加了直入模式)。